import{C as Q,J as W,r as a,j as e,B as h,T as X,S}from"./app-BNvUUmEl.js";import{U,R as _,a as C,b as k}from"./index-DPvysMlI.js";import{P as Z}from"./index-CMRs0_Xi.js";import{R as ee}from"./DeleteOutlined-DGkp8rPa.js";import{s as te}from"./index-CqQEq_8Q.js";import"./pickAttrs-B-O1NeT5.js";import"./EyeOutlined-DiEETj_p.js";import"./context-D9W1Owti.js";import"./CheckOutlined-UVMpW3zu.js";import"./CloseCircleFilled-12r7ww41.js";import"./CloseOutlined-DZW4jfaN.js";import"./useLocale-DhOjA_vR.js";import"./ExclamationCircleFilled-BCKDqmzc.js";const N=n=>{if(!n)return"unknown";const d=n.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif","bmp","webp"].includes(d)?"image":d==="pdf"?"pdf":"other"},ue=({ownerId:n})=>{const d=Q(),{permissions:g}=W().props,L=t=>g==null?void 0:g.includes(t),[x,y]=a.useState(null),[I,w]=a.useState(null),[D,R]=a.useState(null),[P,$]=a.useState(null),[B,T]=a.useState(null),[E,b]=a.useState(0),[M,O]=a.useState([]),[z,A]=a.useState([]),[H,J]=a.useState([]),[V,Y]=a.useState([]),[c,j]=a.useState([]),[q,G]=a.useState([]);a.useEffect(()=>{n&&axios.get(d("media.index",{id:n})).then(t=>{var f,p,m,v;const r=(f=t.data.profile)==null?void 0:f.file_path,s=(p=t.data.idCardFront)==null?void 0:p.file_path,o=(m=t.data.idCardBack)==null?void 0:m.file_path,l=(v=t.data.resume)==null?void 0:v.file_path;w(r?`/storage/${r}`:null),R(s?`/storage/${s}`:null),$(o?`/storage/${o}`:null),T(l?`/storage/${l}`:null);const i=t.data.media||[];G(i)}).catch(t=>{console.error(t)})},[n,E]);const F=(t,r,s)=>{const o=new FormData;s.forEach(l=>{o.append("file",l)}),o.append("user_id",n),o.append("category",t),y(t),S.post(d("media.upload"),o,{preserveScroll:!0,onSuccess:()=>{r([]),b(l=>l+1)},onError:()=>r([]),onFinish:()=>{y(null)}})},K=t=>new Promise(r=>{const s=d("media.destroy",t);S.delete(s,{preserveScroll:!0,onSuccess:()=>{b(o=>o+1),r()},onError:()=>{te.error("Failed to delete department")}})}),u=({title:t,fileUrl:r,defaultImg:s,fileList:o,setFileList:l,category:i})=>{const f=N(r);return e.jsxs("div",{className:"col-12 col-md-3 d-flex flex-column justify-content-between mb-1",children:[e.jsx("figure",{className:"d-flex justify-content-center align-items-center",style:{height:"auto",border:"1px solid #ccc",padding:"6px",maxHeight:"200px",minHeight:"150px",overflow:"hidden"},children:r&&f==="image"?e.jsx("img",{src:r,alt:t,style:i==="profile"?{width:"150px",height:"150px",borderRadius:"50%",objectFit:"contain"}:{width:"100%",objectFit:"contain"}}):r&&f==="pdf"?e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",children:e.jsx(C,{style:{fontSize:"40px",color:"#d32f2f"}})}):r?e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",children:e.jsx(k,{style:{fontSize:"40px",color:"#555"}})}):e.jsx("img",{src:s,alt:t,style:{width:"100%"}})}),e.jsxs("div",{className:"d-flex flex-column",children:[L("Upload Media")&&e.jsx("h6",{className:"text-center",children:t}),e.jsx(U,{fileList:o,onRemove:p=>{const m=[...o];m.splice(o.indexOf(p),1),l(m)},beforeUpload:p=>(l([...o,p]),!1),children:e.jsx(h,{icon:e.jsx(_,{}),children:r?i==="profile"?"Update Profile":i==="resume"?"Update CV":i==="id_card_front"?"Update ID Card Front":i==="id_card_back"?"Update ID Card Back":"Upload Again":"Select File"})}),e.jsx(h,{className:"mt-1",type:"primary",onClick:()=>F(i,l,o),disabled:o.length===0,loading:x===i,children:x===i?"Uploading...":"Start Upload"})]})]})};return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"row",children:[u({title:"User Profile",fileUrl:I,defaultImg:"/storage/uploads/media/default/profile.svg",fileList:M,setFileList:O,category:"profile"}),u({title:"ID Card Front",fileUrl:D,defaultImg:"/storage/uploads/media/default/id_card_front.svg",fileList:z,setFileList:A,category:"id_card_front"}),u({title:"ID Card Back",fileUrl:P,defaultImg:"/storage/uploads/media/default/id_card_back.svg",fileList:H,setFileList:J,category:"id_card_back"}),u({title:"Resume",fileUrl:B,defaultImg:"/storage/uploads/media/default/cv.svg",fileList:V,setFileList:Y,category:"resume"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-12",children:e.jsx("h6",{children:"All & Other"})}),e.jsx("div",{className:"col-md-2 col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx(U,{fileList:c,onRemove:t=>{const r=[...c];r.splice(c.indexOf(t),1),j(r)},beforeUpload:t=>(j([...c,t]),!1),children:e.jsx(h,{icon:e.jsx(_,{}),children:"Upload Other"})}),e.jsx(h,{className:"mt-1",type:"primary",onClick:()=>F("other",j,c),disabled:c.length===0,loading:x==="other",children:x==="other"?"Uploading...":"Start Upload"})]})})]}),e.jsx("div",{className:"row",children:q.map((t,r)=>{const s=`/storage/${t.file_path}`,o=N(s),l=t.category;return e.jsx("div",{className:"col-md-2 col-6",children:e.jsxs("figure",{className:"d-flex justify-content-center align-items-center",style:{border:"1px solid #ccc",position:"relative",marginBottom:"3px",minHeight:"200px"},children:[o==="image"?e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",flexDirection:"column",alignItems:"center",textDecoration:"none",color:"inherit"},children:[e.jsx("img",{src:s,style:{width:"100%"},alt:`media-${r}`}),e.jsx("span",{children:l})]}):o==="pdf"?e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",flexDirection:"column",alignItems:"center",textDecoration:"none",color:"inherit"},children:[e.jsx(C,{style:{fontSize:"40px",color:"#d32f2f"}}),e.jsx("span",{children:l})]}):e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",flexDirection:"column",alignItems:"center",textDecoration:"none",color:"inherit"},children:[e.jsx(k,{style:{fontSize:"40px",color:"#d32f2f"}}),e.jsx("span",{children:l})]}),e.jsx("div",{style:{position:"absolute",top:"0",left:"0"},children:e.jsx(X,{title:`Delete File ${t.category}`,color:"red",placement:"leftTop",children:e.jsx(Z,{title:`Are you sure you want to delete "${t.category}"?`,onConfirm:()=>K(t.id),okText:"Yes",cancelText:"No",children:e.jsx(ee,{style:{border:"1px dashed red"},className:"btn btn-sm btn-danger"})})})})]})},r)})})]})};export{ue as default};
