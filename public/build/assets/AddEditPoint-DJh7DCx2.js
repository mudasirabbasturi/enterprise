import{C as U,r as m,j as s,S as w}from"./app-BNvUUmEl.js";import{S as k}from"./index-CaKXPVzR.js";import{T as F}from"./index-zqShmFR9.js";import"./pickAttrs-B-O1NeT5.js";import"./useVariants-BWWb-x4p.js";import"./useLocale-DhOjA_vR.js";import"./CheckOutlined-UVMpW3zu.js";import"./CloseCircleFilled-12r7ww41.js";import"./CloseOutlined-DZW4jfaN.js";import"./DownOutlined-BiWLPvuA.js";import"./SearchOutlined-CqZ0Ampv.js";import"./BaseInput-DZa833Tk.js";const l=c=>{const u=Number(c);return Number.isFinite(u)?u:0},K=({member_id:c,name:u,points_gain:x,project:o,onClose:N,setParentLoading:n})=>{const v=U(),r=(o==null?void 0:o.project_team_members)??[],p=l(o==null?void 0:o.project_points),j={id:c,points_gain:l(x)},[h,f]=m.useState(!1),[i,d]=m.useState(j);m.useEffect(()=>{d({id:c,points_gain:l(x)})},[c,x]);const S=m.useMemo(()=>r.reduce((t,e)=>(e==null?void 0:e.id)===i.id?t:t+l(e==null?void 0:e.points_gain),0),[r,i.id]),b=Math.max(0,p-S),y=m.useMemo(()=>S+l(i.points_gain),[S,i.points_gain]),_=Math.max(0,p-y),M=t=>{const e=r.find(a=>a.id===t);d({id:t,points_gain:l(e==null?void 0:e.points_gain)})},C=(t,e)=>{{const a=l(e),g=Math.min(Math.max(0,a),b);d(T=>({...T,points_gain:g}));return}},E=()=>{f(!0),n==null||n(!0),w.put(v("AddEditScore",i.id),i,{preserveScroll:!0,onSuccess:()=>{d(j),N()},onError:()=>{f(!1),n==null||n(!1)},onFinish:()=>{f(!1),n==null||n(!1)}})};return s.jsx("div",{className:"container",children:s.jsxs("div",{className:"d-flex justify-content-center flex-column align-items-center",children:[s.jsx("hr",{className:"mb-2 mt-0"}),s.jsx("div",{className:"mt-1 mb-1",children:s.jsx("div",{className:"d-flex bg-light p-2 rounded",children:s.jsx("h6",{style:{textDecoration:"underline"},className:"me-2 mb-0",children:"Project Team Member Score Detail:"})})}),s.jsx("hr",{className:"mb-2 mt-2"}),s.jsxs("ul",{style:{listStyle:"circle",fontStyle:"italic"},children:[s.jsxs("li",{children:["Total Project Points: ",p]}),s.jsxs("li",{children:["Total Points Used: ",y]}),s.jsxs("li",{children:["Total Points Left: ",_]})]}),s.jsx("ul",{style:{listStyle:"circle",fontStyle:"italic"},children:r.map(t=>{var a;const e=t.id===i.id?l(i.points_gain):l(t.points_gain);return s.jsxs("li",{children:[((a=t.user)==null?void 0:a.name)||"Unknown",": ",e," Points"]},t.id)})}),s.jsx("ul",{style:{listStyle:"circle",fontStyle:"italic"},children:s.jsxs("li",{className:"d-flex align-items-center justify-content-between w-100",children:[s.jsx(k,{options:r.map(t=>{var e;return{value:t.id,label:((e=t.user)==null?void 0:e.name)||"Unknown"}})||[],placeholder:"Choose a member",value:i.id,onChange:M,disabled:h}),s.jsx(F,{className:"w-100 ms-1",placeholder:`Enter Points (max ${b})`,value:i.points_gain,onChange:t=>C("points_gain",t),min:0,max:b,disabled:h}),s.jsx("button",{className:"ms-1 btn btn-sm btn-primary",disabled:h,onClick:E,children:"Update"})]})})]})})};export{K as default};
