import{r as m,J as U,C as V,j as s,S as M}from"./app-BNvUUmEl.js";import{I as v}from"./index-CRvW1yVg.js";import{C as b}from"./index-75qltQ9A.js";import"./BaseInput-DZa833Tk.js";import"./TextArea-BZPq0bZ8.js";import"./CloseCircleFilled-12r7ww41.js";import"./useVariants-BWWb-x4p.js";import"./pickAttrs-B-O1NeT5.js";import"./EyeOutlined-DiEETj_p.js";import"./SearchOutlined-CqZ0Ampv.js";const{TextArea:T}=v,X=m.forwardRef(({onClose:N,data:i,permissions:p,setParentLoading:n},C)=>{var j,f,S;const{auth:A}=U().props,t=((f=(j=A.user)==null?void 0:j.role)==null?void 0:f.name)==="Super Admin",a=m.useMemo(()=>{const e={};return p.forEach(l=>{e[l.model]||(e[l.model]=[]),e[l.model].push(l)}),e},[p]),y=V(),h={name:i.name,notes:i.notes,permissions:((S=i.permissions)==null?void 0:S.map(e=>e.id))||[]},R=e=>{d(l=>{const r=l.permissions.includes(e)?l.permissions.filter(o=>o!==e):[...l.permissions,e];return{...l,permissions:r}})},k=e=>c.permissions.includes(e),E=e=>{const l=a[e].map(o=>o.id),r=l.every(o=>c.permissions.includes(o));d(o=>{const w=r?o.permissions.filter(I=>!l.includes(I)):[...new Set([...o.permissions,...l])];return{...o,permissions:w}})},g=e=>a[e].every(l=>c.permissions.includes(l.id)),[G,u]=m.useState(!1),[c,d]=m.useState(h),x=(e,l)=>{d(r=>({...r,[e]:l}))},F=()=>{u(!0),n==null||n(!0),M.put(y("role.update",i.id),c,{preserveScroll:!0,onSuccess:()=>{d(h),N()},onError:()=>{n==null||n(!1),u(!1)},onFinish:()=>{n==null||n(!1),u(!1)}})};return m.useImperativeHandle(C,()=>({submitForm:F})),s.jsx(s.Fragment,{children:s.jsxs("div",{className:"container",children:[s.jsx("hr",{className:"mb-3 mt-0"}),s.jsxs("div",{className:"row mb-3",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsxs("div",{className:"d-flex align-content-center mb-2",children:[s.jsxs("label",{htmlFor:"role",className:"me-1",style:{whiteSpace:"nowrap"},children:["Edit Role Name:",s.jsx("hr",{className:"mt-0 mb-1"}),s.jsx("hr",{className:"mt-0 mb-1"}),s.jsx("hr",{className:"mt-0 mb-1"})]}),s.jsx(v,{value:c.name,onChange:e=>x("name",e.target.value),placeholder:"Enter Role Name",disabled:i.name==="Super Admin"})]}),s.jsx("div",{children:!t&&i.name==="Super Admin"?s.jsx("p",{className:"text-danger",children:"You Can Not Edit Super Admin role."}):"Checked / Unchecked Permission For Role:"}),s.jsx("hr",{className:"mt-1"})]}),s.jsx("div",{className:"col-md-6",children:s.jsxs("div",{className:"d-flex flex-column mb-1",children:[s.jsx("label",{htmlFor:"notes",children:"Notes:"}),s.jsx(T,{value:c.notes,onChange:e=>x("notes",e.target.value),disabled:!t&&i.name==="Super Admin"})]})})]}),s.jsx("hr",{}),s.jsx("div",{style:{columnCount:4,columnGap:"1rem"},children:Object.entries(a).map(([e,l])=>s.jsxs("div",{style:{breakInside:"avoid",background:"#f8f8f8",padding:"10px",marginBottom:"1rem",borderRadius:"8px"},children:[s.jsxs("h6",{style:{color:"#1890ff"},children:["Module: ",e]}),s.jsx(b,{checked:g(e),onChange:()=>E(e),disabled:!t&&i.name==="Super Admin",children:"Select All"}),s.jsx("ul",{style:{listStyleType:"circle",paddingLeft:"1.5rem"},children:l.map(r=>s.jsx("li",{children:s.jsx(b,{checked:k(r.id),onChange:()=>R(r.id),disabled:!t&&i.name==="Super Admin",children:r.name})},r.id))})]},e))})]})})});export{X as default};
