import{r as n,C as k,j as s,S as w}from"./app-BNvUUmEl.js";import{I as p}from"./index-CRvW1yVg.js";import{C as x}from"./index-75qltQ9A.js";import"./BaseInput-DZa833Tk.js";import"./TextArea-BZPq0bZ8.js";import"./CloseCircleFilled-12r7ww41.js";import"./useVariants-BWWb-x4p.js";import"./pickAttrs-B-O1NeT5.js";import"./EyeOutlined-DiEETj_p.js";import"./SearchOutlined-CqZ0Ampv.js";const{TextArea:A}=p,z=n.forwardRef(({onClose:j,permissions:d,setParentLoading:r},f)=>{const m=n.useMemo(()=>{const e={};return d.forEach(l=>{e[l.model]||(e[l.model]=[]),e[l.model].push(l)}),e},[d]),b=k(),u={name:"",notes:"",permissions:[]},v=e=>{t(l=>{const o=l.permissions.includes(e)?l.permissions.filter(i=>i!==e):[...l.permissions,e];return{...l,permissions:o}})},S=e=>c.permissions.includes(e),C=e=>{const l=m[e].map(i=>i.id),o=l.every(i=>c.permissions.includes(i));t(i=>{const R=o?i.permissions.filter(g=>!l.includes(g)):[...new Set([...i.permissions,...l])];return{...i,permissions:R}})},N=e=>m[e].every(l=>c.permissions.includes(l.id)),[E,a]=n.useState(!1),[c,t]=n.useState(u),h=(e,l)=>{t(o=>({...o,[e]:l}))},y=()=>{a(!0),r==null||r(!0),w.post(b("role.store"),c,{preserveScroll:!0,onSuccess:()=>{t(u),j()},onError:()=>{r==null||r(!1),a(!1)},onFinish:()=>{r==null||r(!1),a(!1)}})};return n.useImperativeHandle(f,()=>({submitForm:y})),s.jsx(s.Fragment,{children:s.jsxs("div",{className:"container",children:[s.jsx("hr",{className:"mb-3 mt-0"}),s.jsxs("div",{className:"row mb-3",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsxs("div",{className:"d-flex align-content-center mb-2",children:[s.jsxs("label",{htmlFor:"role",className:"me-1",style:{whiteSpace:"nowrap"},children:["Enter Role:",s.jsx("hr",{className:"mt-0 mb-1"}),s.jsx("hr",{className:"mt-0 mb-1"}),s.jsx("hr",{className:"mt-0 mb-1"})]}),s.jsx(p,{value:c.name,onChange:e=>h("name",e.target.value),placeholder:"Enter Role Name",allowClear:!0})]}),s.jsx("div",{children:"Add Permission To Role:"}),s.jsx("hr",{className:"mt-1"})]}),s.jsx("div",{className:"col-md-6",children:s.jsxs("div",{className:"d-flex flex-column mb-1",children:[s.jsx("label",{htmlFor:"notes",children:"Notes:"}),s.jsx(A,{value:c.notes,onChange:e=>h("notes",e.target.value)})]})})]}),s.jsx("hr",{}),s.jsx("div",{style:{columnCount:4,columnGap:"1rem"},children:Object.entries(m).map(([e,l])=>s.jsxs("div",{style:{breakInside:"avoid",background:"#f8f8f8",padding:"10px",marginBottom:"1rem",borderRadius:"8px"},children:[s.jsxs("h6",{style:{color:"#1890ff"},children:["Module: ",e]}),s.jsx(x,{checked:N(e),onChange:()=>C(e),children:"Select All"}),s.jsx("ul",{style:{listStyleType:"circle",paddingLeft:"1.5rem"},children:l.map(o=>s.jsx("li",{children:s.jsx(x,{checked:S(o.id),onChange:()=>v(o.id),children:o.name})},o.id))})]},e))})]})})});export{z as default};
