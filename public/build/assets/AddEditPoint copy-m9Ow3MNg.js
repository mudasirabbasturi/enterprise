import{r as o,C as T,j as s,S as U}from"./app-BNvUUmEl.js";import{S as k}from"./index-CaKXPVzR.js";import{T as F}from"./index-zqShmFR9.js";import"./pickAttrs-B-O1NeT5.js";import"./useVariants-BWWb-x4p.js";import"./useLocale-DhOjA_vR.js";import"./CheckOutlined-UVMpW3zu.js";import"./CloseCircleFilled-12r7ww41.js";import"./CloseOutlined-DZW4jfaN.js";import"./DownOutlined-BiWLPvuA.js";import"./SearchOutlined-CqZ0Ampv.js";import"./BaseInput-DZa833Tk.js";const l=c=>{const d=Number(c);return Number.isFinite(d)?d:0},K=o.forwardRef(({member_id:c,name:d,points_gain:u,project:a,onClose:N,setParentLoading:n},v)=>{const _=T(),m=(a==null?void 0:a.project_team_members)??[],p=l(a==null?void 0:a.project_points),[x,h]=o.useState(!1),[i,f]=o.useState({id:c,points_gain:l(u)});o.useEffect(()=>{f({id:c,points_gain:l(u)})},[c,u]);const b=o.useMemo(()=>m.reduce((t,e)=>(e==null?void 0:e.id)===i.id?t:t+l(e==null?void 0:e.points_gain),0),[m,i.id]),S=Math.max(0,p-b),j=o.useMemo(()=>b+l(i.points_gain),[b,i.points_gain]),M=Math.max(0,p-j),C=t=>{const e=m.find(r=>r.id===t);f({id:t,points_gain:l(e==null?void 0:e.points_gain)})},E=(t,e)=>{{const r=l(e),g=Math.min(Math.max(0,r),S);f(w=>({...w,points_gain:g}));return}},y=()=>{h(!0),n==null||n(!0),U.put(_("AddEditScore",i.id),i,{preserveScroll:!0,onSuccess:()=>{N()},onError:()=>{n==null||n(!1),h(!1)},onFinish:()=>{n==null||n(!1),h(!1)}})};return o.useImperativeHandle(v,()=>({submitForm:y})),s.jsx("div",{className:"container",children:s.jsxs("div",{className:"d-flex justify-content-center flex-column align-items-center",children:[s.jsx("hr",{className:"mb-2 mt-0"}),s.jsx("div",{className:"mt-1 mb-1",children:s.jsx("div",{className:"d-flex bg-light p-2 rounded",children:s.jsx("h6",{style:{textDecoration:"underline"},className:"me-2 mb-0",children:"Project Team Member Score Detail:"})})}),s.jsx("hr",{className:"mb-2 mt-2"}),s.jsxs("ul",{style:{listStyle:"circle",fontStyle:"italic"},children:[s.jsxs("li",{children:["Total Project Points: ",p]}),s.jsxs("li",{children:["Total Points Used: ",j]}),s.jsxs("li",{children:["Total Points Left: ",M]})]}),s.jsx("ul",{style:{listStyle:"circle",fontStyle:"italic"},children:m.map(t=>{var r;const e=t.id===i.id?l(i.points_gain):l(t.points_gain);return s.jsxs("li",{children:[((r=t.user)==null?void 0:r.name)||"Unknown",": ",e," Points"]},t.id)})}),s.jsx("ul",{style:{listStyle:"circle",fontStyle:"italic"},children:s.jsxs("li",{className:"d-flex align-items-center justify-content-between w-100",children:[s.jsx(k,{options:m.map(t=>{var e;return{value:t.id,label:((e=t.user)==null?void 0:e.name)||"Unknown"}})||[],placeholder:"Choose a member",value:i.id,onChange:C,disabled:x}),s.jsx(F,{className:"w-100 ms-1",placeholder:`Enter Points (max ${S})`,value:i.points_gain,onChange:t=>E("points_gain",t),min:0,max:S,disabled:x}),s.jsx("button",{className:"ms-1 btn btn-sm btn-primary",disabled:x,onClick:y,children:"Update"})]})})]})})});export{K as default};
