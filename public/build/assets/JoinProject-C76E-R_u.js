import{r,J,C as g,j as s,S as A}from"./app-BNvUUmEl.js";import{D as j}from"./index-Dw-fU_By.js";import{C as E}from"./index-75qltQ9A.js";import{I as F}from"./index-CRvW1yVg.js";import{S as T}from"./index-zZUuQW8Z.js";import"./BaseInput-DZa833Tk.js";import"./TextArea-BZPq0bZ8.js";import"./CloseCircleFilled-12r7ww41.js";import"./useVariants-BWWb-x4p.js";import"./pickAttrs-B-O1NeT5.js";import"./EyeOutlined-DiEETj_p.js";import"./SearchOutlined-CqZ0Ampv.js";const K=r.forwardRef(({project:i,onClose:k,setParentLoading:l},y)=>{const{auth:C}=J().props,_=g(),h={project_id:i==null?void 0:i.id,user_id:C.user.id,steps:[],status:"in_progress"},N=[{key:"project_marking",label:"Marking"},{key:"project_excel",label:"Excel Sheet"},{key:"project_pricing",label:"Project Pricing"},{key:"project_quality_assurance",label:"Quality Assurance"}],[a,x]=r.useState([]),[n,m]=r.useState(""),[u,f]=r.useState([]),[v,S]=r.useState(h),[p,d]=r.useState(!1),w=(e,o)=>{f(t=>o?[...t,e]:t.filter(c=>c!==e)),S(t=>({...t,steps:o?[...t.steps,e]:t.steps.filter(c=>c!==e)}))},I=()=>{const e=n.trim().toLowerCase().replace(/\s+/g,"_"),o=n.trim();if(!e||u.includes(e)||a.find(c=>c.key===e))return;const t={key:e,label:o};x([...a,t]),m("")},b=()=>{d(!0),l==null||l(!0),A.post(_("JoinProject",{ProjectId:i.id}),v,{preserveScroll:!0,onSuccess:()=>{S(h),f([]),x([]),m(""),k()},onError:()=>{l==null||l(!1),d(!1)},onFinish:()=>{l==null||l(!1),d(!1)}})};return r.useImperativeHandle(y,()=>({submitForm:b})),s.jsx(s.Fragment,{children:s.jsxs("div",{className:"d-flex align-items-center flex-column p-3",children:[s.jsx("h6",{className:"text-center mb-3",children:"Choose Tasks To Join The Project"}),s.jsx(j,{}),[...N,...a].map((e,o)=>s.jsx(E,{checked:u.includes(e.key),onChange:t=>w(e.key,t.target.checked),className:o>0?"ms-3":"",children:e.label},e.key)),s.jsx("div",{className:"mt-3 d-flex",children:s.jsx(F,{type:"text",value:n,onChange:e=>m(e.target.value),placeholder:"Add custom task...",allowClear:!0,suffix:s.jsx("button",{className:"btn btn-primary btn-sm m-0 border-0",onClick:I,disabled:!n.trim(),children:"Add More!"})})}),s.jsx(j,{}),s.jsx("div",{className:"d-flex justify-content-center",children:s.jsx("button",{className:`btn btn-sm ${p?"btn-light border":"btn-primary"}`,onClick:b,disabled:p||u.length===0,children:p?s.jsx(T,{size:"small",children:"Joining Project Wait..."}):"Join Project"})})]})})});export{K as default};
